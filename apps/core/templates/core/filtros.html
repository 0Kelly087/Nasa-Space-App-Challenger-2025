<!DOCTYPE html>
<html lang="es">

<head>
  {% load static %}

  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Filtros - Misi√≥n TEMPO</title>

  <!-- Fuente y CSS principal -->
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300;500;700&display=swap" rel="stylesheet" />
  <link rel="stylesheet" type="text/css" href="{% static 'css/mapa.css' %}">

  <!-- Leaflet CSS -->
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />

</head>

<body class="filtros-page">
  <div class="overlay"></div>

  <div class="container filtros-container">
    <h1>
      <span class="blanco">CENTRO DE FILTROS DE LA </span>
      <span class="azul"> MISI√ìN TEMPO</span>
    </h1>
    <p>Selecciona una localidad de Bogot√° para obtener informaci√≥n detallada.</p>

    <!-- Barra de Filtros -->
    <div class="barra-filtros">
      <select id="localidad">
        <option value="">Seleccione una localidad</option>
        <option value="Antonio Nari√±o">Antonio Nari√±o</option>
        <option value="Barrios Unidos">Barrios Unidos</option>
        <option value="Bosa">Bosa</option>
        <option value="Candelaria">La Candelaria</option>
        <option value="Chapinero">Chapinero</option>
        <option value="Ciudad Bolivar">Ciudad Bol√≠var</option>
        <option value="Engativa">Engativ√°</option>
        <option value="Fontibon">Fontib√≥n</option>
        <option value="Kennedy">Kennedy</option>
        <option value="Los Martires">Los M√°rtires</option>
        <option value="Puente Aranda">Puente Aranda</option>
        <option value="Rafael Uribe Uribe">Rafael Uribe Uribe</option>
        <option value="San Cristobal">San Crist√≥bal</option>
        <option value="Santa Fe">Santa Fe</option>
        <option value="Suba">Suba</option>
        <option value="Sumapaz">Sumapaz</option>
        <option value="Teusaquillo">Teusaquillo</option>
        <option value="Tunjuelito">Tunjuelito</option>
        <option value="Usaquen">Usaqu√©n</option>
        <option value="Usme">Usme</option>

      </select>

      <button onclick="mostrarInfo()">Filtrar</button>
    </div>

    <!-- Contenedor principal con mapa y resultados -->
    <div class="contenido-principal">
      <!-- Mapa -->
      <div id="map"></div>

      <!-- Resultado del filtro -->
      <div id="resultado" class="resultado">
        <div>
          <h2 id="tituloLocalidad"></h2>
          <p id="infoLocalidad"></p>
        </div>
        <p>Dale clic en continuar con las predicciones para conocer las condiciones actuales del aire y sus
          predicciones.</p>
        <button type="button" onclick="continuarPrediccion()" class="btn-prediccion">Continuar con las
          Predicciones</button>
      </div>
    </div>
  </div>

  <style>
    .btn-prediccion {
      display: inline-block;
      padding: 15px 35px;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      text-decoration: none;
      border-radius: 50px;
      cursor: pointer;
      border: none;
      font-size: 16px;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 1px;
      box-shadow: 0 10px 25px rgba(102, 126, 234, 0.4);
      transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
      position: relative;
      overflow: hidden;
      margin-top: 20px;
    }

    .btn-prediccion::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(135deg, #764ba2 0%, #667eea 100%);
      transition: left 0.4s ease;
      z-index: -1;
    }

    .btn-prediccion:hover {
      transform: translateY(-3px) scale(1.05);
      box-shadow: 0 15px 35px rgba(102, 126, 234, 0.6);
    }

    .btn-prediccion:hover::before {
      left: 0;
    }

    .btn-prediccion:active {
      transform: translateY(-1px) scale(1.02);
      box-shadow: 0 8px 20px rgba(102, 126, 234, 0.5);
    }
  </style>
  <footer>¬© 2025 Misi√≥n TEMPO - Proyecto NASA Space Apps</footer>

  <!-- Scripts -->
  <script>
     document.addEventListener("DOMContentLoaded", () => {
    setTimeout(() => {
      document.body.classList.add("loaded");
    }, 400);
    });
    function continuarPrediccion() {
      console.log('=== EJECUTANDO continuarPrediccion ===');

      // Obtener la localidad seleccionada
      const select = document.getElementById("localidad");
      const localidad = select ? select.value : '';

      console.log('Localidad seleccionada:', localidad);

      if (localidad && localidad !== "") {
        // Guardar en localStorage
        localStorage.setItem('localidadSeleccionada', localidad);
        console.log('‚úÖ Localidad guardada en localStorage:', localidad);

        // Verificar que se guard√≥
        const verificacion = localStorage.getItem('localidadSeleccionada');
        console.log('‚úÖ Verificaci√≥n localStorage:', verificacion);

        // Redirigir despu√©s de guardar
        setTimeout(() => {
          console.log('üîÄ Redirigiendo a predicciones...');
          window.location.href = "{% url 'predicciones' %}";
        }, 100);
      } else {
        console.log('‚ùå No hay localidad seleccionada');
        alert('Por favor, selecciona una localidad antes de continuar.');
      }
    }
  </script>

  <!-- Leaflet JS -->
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

  <script src="{% static 'js/mapa.js' %}"></script>

</body>

</html>